#!/bin/bash
# usage: print-test-page <PRINTER_NAME> <PDF_FILE>
#
# By default PRINTER_NAME is assume the first enabled printer in the system
# PDF_FILE is assumed to be the default testpage on the system
#

# set -eux

get-default-enabled-printer () {
    lpstat -p | grep enabled | cut -d ' ' -f 2
}


DEFAULT_PRINTER=$(get-default-enabled-printer)
PRINTER_NAME="${1:-${DEFAULT_PRINTER}}"
DOCUMENT="$1"

lp -o sides=two-sided-long-edge -d "${PRINTER_NAME}" -o prettyprint=true "${DOCUMENT}"

echo "Document ${DOCUMENT} requested to print in the printer $PRINTER_NAME."
